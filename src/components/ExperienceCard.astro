---
import type { Bullet } from '../data/experience';

interface Props {
    company: string;
    role: string;
    duration: string;
    bullets: Bullet[];
    index: number;
    total: number;
}

const { company, role, duration, bullets, index, total } = Astro.props;
const isLast = index === total - 1;

function renderBullet(bullet: Bullet): string {
    let html = bullet.text;
    for (const highlight of bullet.highlights) {
        html = html.replace(
            highlight,
            `<span style="color: var(--color-accent);">${highlight}</span>`,
        );
    }
    return html;
}
---

<article
    class="experience-card"
>
    <div class="experience-card-header">
        <div class="flex flex-col gap-1 sm:flex-row sm:items-baseline sm:justify-between">
            <h3
                class="font-bold"
                style={`color: var(--color-text); font-size: clamp(1.5rem, 3vw, 2.5rem);`}
            >
                {company}
            </h3>
            <span
                class="text-xs uppercase tracking-widest sm:text-sm"
                style="color: var(--color-muted);"
            >
                {duration}
            </span>
        </div>

        <p class="mt-1" style="color: var(--color-accent);">
            {role}
        </p>
    </div>

    <div class="experience-card-body">
        <ul class="flex flex-col gap-4">
            {bullets.map((bullet) => (
                <li
                    class="leading-relaxed md:text-base"
                    style="color: var(--color-text);"
                    set:html={renderBullet(bullet)}
                />
            ))}
        </ul>
    </div>
</article>
