---
import type { Bullet } from '../data/experience';

interface Props {
    company: string;
    role: string;
    duration: string;
    bullets: Bullet[];
    index: number;
    total: number;
}

const { company, role, duration, bullets, index, total } = Astro.props;
const isLast = index === total - 1;

function renderBullet(bullet: Bullet): string {
    let html = bullet.text;
    for (const highlight of bullet.highlights) {
        html = html.replace(
            highlight,
            `<span style="color: var(--color-accent);">${highlight}</span>`,
        );
    }
    return html;
}
---

<article
    class="experience-card"
    style={`top: ${(index + 1) * 25}px;`}
>
    <div class="flex flex-col gap-1 sm:flex-row sm:items-baseline sm:justify-between">
        <h3
            class="text-lg font-bold sm:text-xl md:text-2xl"
            style="color: var(--color-text);"
        >
            {company}
        </h3>
        <span
            class="text-xs tracking-wide sm:text-sm"
            style="color: var(--color-muted);"
        >
            {duration}
        </span>
    </div>

    <p class="mt-1 text-sm" style="color: var(--color-accent);">
        {role}
    </p>

    <ul class="mt-4 flex flex-col gap-3">
        {bullets.map((bullet) => (
            <li
                class="text-sm leading-relaxed md:text-base"
                style="color: var(--color-text);"
                set:html={renderBullet(bullet)}
            />
        ))}
    </ul>
</article>
